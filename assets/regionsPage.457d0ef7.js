import{Q as O}from"./QPage.6503ee05.js";import{Y as S,i as _,r as i,n as P,at as L,_ as D,Z as B,a0 as F,o as g,c as $,w as a,b as o,a2 as p,ah as f,ag as h,aN as Y,aO as H,aP as K,a5 as C,q as j,a as v,a1 as V,aj as Q,a4 as x,as as Z,ai as G,$ as W}from"./index.3698d03c.js";import{e as R,h as A,k as I,C as J,c as M,i as X,r as ee,m as T,S as te,l as oe,n as se,o as ae}from"./SortableButtonsComponent.2dea1bfa.js";import{Q as ne}from"./QScrollArea.76c6595f.js";import{a as w,b as le,c as ie,Q as U}from"./QCard.46c77733.js";import{b as N,Q as k,a as E}from"./QItem.7508c887.js";import{Q as re}from"./QResponsive.9dc34685.js";import{B as de,S as ue}from"./smalCard.cdf24b58.js";import"./use-dark.f48971e5.js";import"./use-timeout.3f01649d.js";const me=S({emit:["v-close-popup"],props:{hasEdit:{type:Boolean,default:()=>!1}},setup(e,{emit:t}){let n=_("items/regions"),r=i({});const l=_("users"),d=i(null);let s=i(null);const m=async(y,u,c)=>{const q=B.getItem("lesguides_userConnected");if(console.log("je suis ici"),l.limit.value=50,l.filters.value={_and:[{role:{_eq:q.role}},{id:{_neq:q.id}},{titre:{niveau:{_gt:5}}}]},l.fields.value="id, avatar, contact, email, first_name, last_name, profession, genre.*, genre.branches.*, genre.branches.grades.*,branche.*, branche.grades.*,grade.*,troupe.*, troupe.districts.*, troupe.districts.list_troupe.*, troupe.districts.regions.*,troupe.districts.regions.list_district.*,troupe.districts.regions.list_district.list_troupe.*,titre.*,situation_matrimonial.* ",await l.getItems(),s.value=l.items.value,console.log("list_user",s.value),s.value!==null){u();return}},b=async()=>{d.value.validate()&&(F("info","addRegion | onSubmit",n.createForm.value),n.item.value=r.value,e.hasEdit?await n.update():await n.create(),t("VClosePopup"))};return P(()=>{e.hasEdit&&(r.value=n.item.value)}),{stateRegion:n,nom_regionRef:d,list_user:s,formData:r,assetsUrl:L,onSubmit:b,fetchDataUser:m}}}),pe={class:"text-h2 q-py-xs"},ce={class:"text-bold text-uppercase"};function ge(e,t,n,r,l,d){return g(),$(U,{class:"my-card",style:{"min-width":"75vw"}},{default:a(()=>[o(w,{horizontal:"",class:"row"},{default:a(()=>[o(w,{class:"col-3 flex flex-center bg-green-10 no-padding text-green-2 text-bold"},{default:a(()=>[o(R,{src:"region.jpg","spinner-color":"primary","spinner-size":"82px",height:"100%",fit:"cover"})]),_:1}),o(w,{class:"col-grow"},{default:a(()=>[p("div",pe,f(e.hasEdit?"Modification":"Ajout")+"de r\xE9gion ",1),o(le,null,{default:a(()=>[o(w,{class:"q-gutter-sm"},{default:a(()=>[o(ie,{modelValue:e.formData.nom_region,"onUpdate:modelValue":t[0]||(t[0]=s=>e.formData.nom_region=s),type:"text",label:"Nom de la r\xE9gion",color:"green-10",class:"bg-green-1 q-pl-sm",style:{"border-radius":"0.8rem"},rounded:"",borderless:"",rules:[s=>s&&s.length>0||"Ce champ est obligatoire"],"no-error-icon":"","lazy-rules":"","hide-bottom-space":"",ref:"nom_regionRef"},null,8,["modelValue","rules"]),o(A,{modelValue:e.formData.cr_actuel,"onUpdate:modelValue":t[1]||(t[1]=s=>e.formData.cr_actuel=s),options:e.list_user,label:"Commissaire de r\xE9gion actuelle",color:"green-10",class:"bg-green-1 q-pl-sm",style:{"border-radius":"0.8rem"},rounded:"",borderless:"","option-value":"id",onFilter:e.fetchDataUser,"option-label":s=>s===null?"Null value":s.first_name+" "+s.last_name},{"no-option":a(()=>[o(N,null,{default:a(()=>[o(k,{class:"text-italic text-grey"},{default:a(()=>[h(" Aucun membre avec le titre disponible ")]),_:1})]),_:1})]),option:a(s=>[o(N,Y(H(s.itemProps)),{default:a(()=>[o(k,{avatar:""},{default:a(()=>[o(K,{color:"green-1"},{default:a(()=>[s.opt.avatar?(g(),$(R,{key:0,"spinner-color":"white",src:e.assetsUrl+s.opt.avatar+"?fit=cover&width=100&height=100&quality=25"},null,8,["src"])):(g(),$(R,{key:1,src:"icons/boy-scout.png",fit:"cover",ratio:1,width:"40%"}))]),_:2},1024)]),_:2},1024),o(k,null,{default:a(()=>[o(E,null,{default:a(()=>[p("span",ce,f(s.opt.titre.libelle),1),h(" "+f(s.opt.first_name)+" "+f(s.opt.last_name),1)]),_:2},1024),h(" "+f(s.opt.troupe.districts.regions.nom_region)+" ",1),o(E,{caption:""},{default:a(()=>[h(f(s.opt.troupe.nom_troupe),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","onFilter","option-label"]),o(A,{modelValue:e.formData.ville_associe,"onUpdate:modelValue":t[2]||(t[2]=s=>e.formData.ville_associe=s),label:"Ville associ\xE9",color:"green-10",class:"bg-green-1 q-pl-sm",style:{"border-radius":"0.8rem"},rounded:"",borderless:""},null,8,["modelValue"])]),_:1}),o(I,{align:"right"},{default:a(()=>[o(C,{"no-caps":"",unelevated:"",color:"green-10",padding:"sm lg",style:{"border-radius":"0.8rem"},onClick:e.onSubmit},{default:a(()=>[h(f(e.hasEdit?"Sauvegarder":"Enregistrer"),1)]),_:1},8,["onClick"]),j(o(C,{label:"Annuler",outline:"",padding:"sm lg",type:"reset",color:"green-8","no-caps":"",onClick:t[3]||(t[3]=s=>e.formData={}),style:{"border-radius":"0.8rem"}},null,512),[[J]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}var z=D(me,[["render",ge]]);const fe=S({components:{addComponent:z},emit:["v-close-popup"],props:{item:{type:Object,required:!0}},setup(e,{emit:t}){let n=_("items/regions"),r=i({});P(()=>{r.value=n.item.value});const l=i(!1);return{onEdit:()=>{l.value=!l.value,n.item.value=e.item},editShow:l}}});function ve(e,t,n,r,l,d){const s=v("add-component");return g(),V(Q,null,[o(C,{flat:"",icon:"o_edit",color:"green-10",onClick:t[0]||(t[0]=m=>e.onEdit())}),o(M,{modelValue:e.editShow,"onUpdate:modelValue":t[2]||(t[2]=m=>e.editShow=m)},{default:a(()=>[o(s,{hasEdit:"",onVClosePopup:t[1]||(t[1]=m=>e.editShow=!e.editShow)})]),_:1},8,["modelValue"])],64)}var _e=D(fe,[["render",ve]]);const be=S({emit:["v-close-popup"],setup(e,{emit:t}){let n=_("items/regions");return i({}),{yesDelete:async()=>{console.log("idci",n.item.value),await n.remove(),t("VClosePopup")}}}}),he=p("div",{class:"q-px-md text-center text-bold text-blue-grey-6"}," \xCAtes vous sure de vouloir supprimer la R\xE9gion de Danan\xE9 ? ",-1);function we(e,t,n,r,l,d){return g(),$(re,{ratio:4/3,style:{width:"50vw"}},{default:a(()=>[o(U,{class:"column",flat:""},{default:a(()=>[o(w,{class:"col q-gutter-y-md column flex flex-center"},{default:a(()=>[o(x,{name:"fa-solid fa-exclamation",color:"amber-5",size:"xl"}),he]),_:1}),o(I,{align:"center"},{default:a(()=>[o(C,{flat:"","no-caps":"",label:"Oui, supprimer",class:"bg-red-12 text-white text-weight-bolder",padding:"sm  md",onClick:t[0]||(t[0]=s=>e.yesDelete())}),j(o(C,{flat:"","no-caps":"",label:"Non, abandoner",color:"red-3",class:"text-blue-grey-5 text-weight-bolder",padding:"sm  "},null,512),[[J]])]),_:1})]),_:1})]),_:1})}var $e=D(be,[["render",we]]);const ye=S({components:{editComponent:_e,deleteComponent:$e,BrancheState:de,SmalCard:ue,deleteBtnComponent:X},props:{item:{type:Object,required:!0}},setup(e){const t=_("items/regions"),n=_("items/districts");_("items/troupes");let r=i(0);_("users");const l=i(0),d=i(0),s=i(!1),m=i(!1);let b=i({days:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],daysShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],months:["Janvier","Fevrier","Mars","Avril","Mai","Juin","Juillet","Ao\xFBt","Septembre","Octobre","Novembre","D\xE9cembre"],monthsShort:["Jan","Fev","Mar","Avr","Mai","Ju","Juil","Ao\xFBt","Sept","Oct","Nov","Dec"]});const y=c=>{t.item.value=c,s.value=!s.value},u=async c=>{t.item.value=c,m.value=!m.value};return P(()=>{console.log("one regions",e.item);let c=0;for(const q of e.item.list_district)q.list_troupe&&(c+=q.list_troupe.length);d.value=c}),{date:ee,totalMembre:r,options:b,editShow:s,editItem:y,deleteItem:u,showDeleted:m,nombreTroupe:d,stateDistrict:n,nombreDistrict:l}}}),Ve={class:"text-h6"},Ce={key:0,class:"flex flex-center text-subtitle col-6"},Se={class:"text-uppercase q-pr-sm"},De={key:1},qe={class:"row"},Qe={class:"col-6 q-pa-xs"},Me={class:"col-6 q-pa-xs"},Pe={class:"col-12 q-pa-xs"},Re={class:"row text-grey-8 text-weight-thin items-center q-pl-sm text-italic"};function ke(e,t,n,r,l,d){const s=v("smal-card"),m=v("branche-state"),b=v("edit-component"),y=v("delete-btn-component"),u=v("delete-component");return g(),V(Q,null,[o(U,{class:"my-card q-pa-xs",flat:"",style:{"border-radius":"0.8rem"}},{default:a(()=>[o(w,{class:"text-center text-grey-8"},{default:a(()=>[p("div",Ve,f(e.item.nom_region),1),e.item.cr_actuel?(g(),V("div",Ce,[p("span",Se,[o(x,{name:"r_school",size:"sm"})]),h(" "+f(e.item.cr_actuel.last_name)+" "+f(e.item.cr_actuel.first_name),1)])):(g(),V("div",De,"-"))]),_:1}),o(w,{class:"q-py-none"},{default:a(()=>[p("div",qe,[p("div",Qe,[o(s,{iconName:"r_signpost",textToView:e.item.list_district_count},null,8,["textToView"])]),p("div",Me,[o(s,{iconName:"r_push_pin",textToView:e.nombreTroupe},null,8,["textToView"])]),p("div",Pe,[o(m,{service:"items/regions",searchKey:e.item.id,regions:""},null,8,["searchKey"])])])]),_:1}),p("div",Re,[h(f(e.date.formatDate(e.item.date_created,"D MMMM YYYY",e.options))+" ",1),o(T),o(I,{align:"right"},{default:a(()=>[o(b,{item:e.item},null,8,["item"]),o(y,{model:"items/regions",libelle:e.item.nom_region,item:e.item},null,8,["libelle","item"])]),_:1})])]),_:1}),o(M,{modelValue:e.editShow,"onUpdate:modelValue":t[1]||(t[1]=c=>e.editShow=c)},{default:a(()=>[o(b,{onVClosePopup:t[0]||(t[0]=c=>e.editShow=!e.editShow)})]),_:1},8,["modelValue"]),o(M,{modelValue:e.showDeleted,"onUpdate:modelValue":t[3]||(t[3]=c=>e.showDeleted=c)},{default:a(()=>[o(u,{onVClosePopup:t[2]||(t[2]=c=>e.showDeleted=!e.showDeleted)})]),_:1},8,["modelValue"])],64)}var Ie=D(ye,[["render",ke]]);const Ue=S({components:{itemComponent:Ie,AddComponent:z,SearchComponent:te,SortableButtonsComponent:oe},setup(){i();const e=i(!1);let t=_("items/regions");i();let n=i(1),r=i(!0);i(!1);let l=()=>Math.ceil(t.totalItem.value/8);const d=async()=>{t.limit.value=8,t.sort.value="-date_created",t.fields.value="*,count(list_district),list_district.*, cr_actuel.*, cr_actuel.titre.*",t.filters.value={deleted:{_eq:!1}},await t.getItems(),l()},s=async()=>{await d(),e.value=!1};return P(()=>{t.page.value=n.value,d(),r.value=!1}),{addComponentHide:s,pagination:async()=>{await t.getItems(),F("info","paginations: ",n.value)},currentPage:n,addShow:e,stateRegion:t,waiting:r,paginationCount:l}}}),Ae={class:"q-mt-md no-padding"},Ne={class:"text-h6"},Ee={class:"row q-px-xs q-gutter-x-sm"},Be={class:"row"};function Fe(e,t,n,r,l,d){const s=v("sortable-buttons-component"),m=v("search-component"),b=v("item-component"),y=v("add-component");return g(),V(Q,null,[p("section",Ae,[p("div",Ne," List des r\xE9gions ( "+f(e.stateRegion.totalItem.value)+" ) ",1),p("div",Ee,[o(C,{class:"rounded-borders",unelevated:"",color:"green-6","no-caps":"",icon:"r_add",label:"Ajouter",padding:"sm md",onClick:t[0]||(t[0]=u=>e.addShow=!e.addShow)}),o(s,{model:"items/regions",sortedField:"nom_region"}),o(T),o(m,{model:"items/regions",filterField:"nom_region",libelle:"Rechercher une r\xE9gion"}),e.paginationCount()>1?(g(),$(se,{key:0,unelevated:"","active-design":"unelevated","active-color":"green-5",color:"green-2",modelValue:e.stateRegion.page.value,"onUpdate:modelValue":[t[1]||(t[1]=u=>e.stateRegion.page.value=u),t[2]||(t[2]=u=>e.pagination())],"boundary-numbers":!1,"max-pages":5,max:e.paginationCount()},null,8,["modelValue","max"])):Z("",!0)]),o(ne,{class:"q-mt-sm relative-position",style:{height:"79vh"}},{default:a(()=>[p("template",Be,[(g(!0),V(Q,null,G(e.stateRegion.items.value,u=>(g(),$(ae,{key:u.id,once:"",class:"col-lg-3 col-md-4 col-sm-6 q-pa-xs",transition:"scale"},{default:a(()=>[o(b,{item:u},null,8,["item"])]),_:2},1024))),128))])]),_:1})]),o(M,{modelValue:e.addShow,"onUpdate:modelValue":t[4]||(t[4]=u=>e.addShow=u)},{default:a(()=>[o(y,{onVClosePopup:t[3]||(t[3]=u=>e.addComponentHide())})]),_:1},8,["modelValue"])],64)}var je=D(Ue,[["render",Fe]]);const xe=S({components:{itemsComponent:je},name:"regionsPage",setup(){const e=W();B.has("lesguides_userConnected")||e.push("/")}});function Je(e,t,n,r,l,d){const s=v("items-component");return g(),$(O,{padding:""},{default:a(()=>[o(s)]),_:1})}var Xe=D(xe,[["render",Je]]);export{Xe as default};
